<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.sonatype.com/tmp/docbook/xml/4.5/docbookx.dtd">
<chapter id="chapter-maven">
  <title>Working with Apache Maven Builds</title>

  <section>
    <title>Installing and Configuring Apache Maven</title>
    <!-- HBOOK-69-->
        <para>
      xref to global config,
      talk about install options (e.g. downside of package managed maven in
      terms of version), what about multiple versions
    </para>
  </section>

  <section>
    <title>A Simple Example for a Apache Maven built project</title>
    <!-- HBOOK-70-->
        <para>should be a simple project which just calls mvn clean install,
      talk about pros and cons of using clean, also talk about plugin:goal
      steps?
    </para>
  </section>

  <section>
    <title>Details of Configuring Maven Build Options</title>
    <!-- HBOOK-71-->

    <para>After configuring the general project options
      (see <xref linkend="chapter-build-creation"/>),
      you can configure one
      or more build steps. To add a build step, click on the Add build step
      button as shown in<xref linkend="fig-using-new-build-config"/>. To
      configure a Maven build, select "Invoke top-level Maven targets".
    </para>

    <figure id="fig-using-new-build-config">
      <title>Configuring Project Build Options</title>

      <mediaobject>
        <imageobject role="web">
          <imagedata contentdepth="100%"
                     fileref="figs/web/ci-using-new-build-config.png"
                     scalefit="1" />
        </imageobject>

        <imageobject role="print">
          <imagedata align="center"
                     fileref="figs/print/ci-using-new-build-config.pdf"
                     scalefit="0" width="100%" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>The basic and advanced options for invoking a top-level Maven
    target are shown in <xref linkend="fig-using-top-level-maven" />.</para>

    <figure id="fig-using-top-level-maven">
      <title>Configuring Top-level Maven Build Options</title>

      <mediaobject>
        <imageobject role="web">
          <imagedata contentdepth="100%"
                     fileref="figs/web/ci-using-top-level-maven.png"
                     scalefit="1" />
        </imageobject>

        <imageobject role="print">
          <imagedata align="center"
                     fileref="figs/print/ci-using-top-level-maven.pdf"
                     scalefit="0" width="100%" />
        </imageobject>
      </mediaobject>
    </figure>

    <variablelist>
      <varlistentry>
        <term>Maven Version</term>
        <listitem>
          <para>Your Hudson installation may have one or more Maven
            installations configured as part of the global Hudson configuration.
            This dropdown allows you to specific version of Maven for usage with
            the current project.
          </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Goals</term>
        <listitem>
          <para>This field allows you to specify the command line
            parameters used for the Maven invocation. These are phases,
            plugin goals as well as specific Maven command-line options like
            -P profile selection, selection of a specific settings.xml file and
            so on.</para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>POM</term>
        <listitem>
          <para>If your project uses the standard pom.xml filename, there is no
            need to specify a POM. If your projects uses a POM with an
            alternative name or path other than directly in the project root,
            you should specify that file name here.
          </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Properties</term>
        <listitem>
          <para>You can pass one or more properties to the Maven process. This
            field accepts a list of properties in a "key=value" format per line,
            which will affect the execution of the Maven build.
          </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>JVM Options</term>
        <listitem>
          <para>If your build requires specific JVM options, they can be set in
            this field. Note that if your build requires MAVEN_OPTS this is a
            separate variable which is described in the section dealing with
            Maven installation configuration. The format for the JVM options is
            the standard -Xoption=value format with multiple parameters
            separated by spaces.
          </para>
        </listitem>
      </varlistentry>

      <varlistentry>
        <term>Use private Maven repository</term>
        <listitem>
          <para>By default a Maven invocation will use a local repository in
            the current users home directory taking any further
            repository configuration done in settings.xml into account. Depending
            on the necessary separation of the different jobs running on
            Hudson it can be useful to have a separate Maven repository for
            each project. Activating this feature will cause the creation of
            a separate Maven repository in a .repository folder in the
            projects workspace. This can cause considerable usage of storage
            space, which consequently should be monitored carefully.
          </para>
        </listitem>
      </varlistentry>

    </variablelist>
  </section>

  <section>
    <title>Managing the build artifacts of a Maven build</title>
    <!-- HBOOK-72 -->
    <para>in hudson artifact, Nexus, Sonar, in hudson maven repo plugin.
      .</para>
  </section>

  <section>
    <title>Complex builds with Maven multi-module setup</title>
    <!-- HBOOK-73-->
    <para></para>
  </section>

  <section>
    <title>Complex builds with Hudson job dependencies</title>
    <!-- HBOOK-74-->
    <para></para>
  </section>

  <section>
    <title>Automating release builds</title>
    <!-- HBOOK-75-->
    <para></para>
  </section>

</chapter>
