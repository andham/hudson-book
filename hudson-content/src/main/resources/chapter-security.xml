<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN"
"http://www.discursive.com/docbook/xml/4.5/docbookx.dtd">
<chapter id="chapter-security">
  <title>Securing Hudson</title>

  <para>As an important part for a software development infrastructure Hudson
  is often installed on local networks. No further security requirements 
    might be needed, when all users on the network are trusted. However with 
    distributed teams, cooperation between companies, 
    external contractors or just open source projects publicly available 
    there are plenty of use cases that require Hudson to be secured. </para>
  <para>Out of the box Hudson has no security enabled, but it can easily be
    turned on checking
    <option>Enable security</option>
    in the global configuration of Hudson as displayed in<xref
      linkend="fig-global-hudson-configuration"/>.
  </para>

  <section>
    <title>Security Settings Overview</title>

    <figure id="fig-security-overview">
      <title>Overview of the available security settings</title>
      <mediaobject>
        <imageobject role="web">
          <imagedata contentdepth="100%"
                     fileref="figs/web/security-overview.png" scalefit="1"/>
        </imageobject>
        <imageobject role="print">
          <imagedata align="center" fileref="figs/print/security-overview.pdf"
                     scalefit="0" width="100%"/>
        </imageobject>
      </mediaobject>
    </figure>

  </section>

  <section>
    <title>Miscellaneous Security Related Settings</title>

    <para></para>
    <variablelist>
      <varlistentry>
        <term>TCP port for JNLP slave agents</term>
        <listitem>
          <para>fixed random and disable</para>
        </listitem>
      </varlistentry>
      <varlistentry>
        <term>Markup Formatter</term>
        <listitem>
          <para>Raw HTML,  others?</para>
        </listitem>
      </varlistentry>
    </variablelist>
  </section>

  <section>
    <title>Access Control</title>

    <para>With security enabled Hudson supports the following security
      providers</para>

    <itemizedlist>
      <listitem>
        <para>Delegate to servlet container</para>
      </listitem>
      <listitem>
        <para>Unix user/group database</para>
      </listitem>
      <listitem>
        <para>Hudson's own user database</para>
      </listitem>
      <listitem>
        <para>LDAP</para>
      </listitem>
    </itemizedlist>

    <para>and authorization schemes,</para>
    <itemizedlist>
      <listitem>
        <para>Logged-in users can do anything</para>
      </listitem>
      <listitem>
        <para>Matrix-based security</para>
      </listitem>
      <listitem>
        <para>Project-based Matrix Authorizations Strategy</para>
      </listitem>
      <listitem>
        <para>Legacy mode</para>
      </listitem>
      <listitem>
        <para>Anyone can do anything</para>
      </listitem>
    </itemizedlist>
    <para>which can be seen in <xref linkend="fig-security-overview"/> and
      will be documented in detail below.</para>


    <section>
      <title>Configuring Security Realms</title>

      <para></para>

      <section>
        <title>Delegating to a Servlet Container</title>
        <!--We need a walk-through for how this works.  We also need to
        motivation and explanation.   What protocol is used?  How does this work?
      SEE HBOOK-47-->
        <para>Selecting this option will allow you to use a custom web
        application to perform authentication.</para>
      </section>

      <section>
        <title>Relying on Unix Users and Groups</title>
        <para>If you select this option, Hudson will consult the Unix
        user/group database on the machine it is running on.</para>
        <figure id="fig-security-unix">
          <title>Overview of the available security settings</title>
          <mediaobject>
            <imageobject role="web">
              <imagedata contentdepth="100%"
                         fileref="figs/web/security-unix.png" scalefit="1"/>
            </imageobject>
            <imageobject role="print">
              <imagedata align="center" fileref="figs/print/security-unix.pdf"
                         scalefit="0" width="100%"/>
            </imageobject>
          </mediaobject>
        </figure>
        <!--This section needs to explore the details of relying on the Unix user/group database from the previous section.   Talk about the
  limitations of this approach.   How does it work?   Are there any limitations?   what are the pros and cons?   Try to get specific
  here by showing people what specific commands can be used to user new users and manage groups.    Feel free to choose a Linux flavor
  for this and provide some handwaving examples for other platforms.
  SEE HBOOK-46-->
        <para></para>
      </section>

      <section>
        <title>Using the Hudson Internal User Database</title>
        <!--What does this mean to the user?
        SEE HBOOK-49-->
        <para>Selecting Internal user database gives you the ability to
        define users directly in the Hudson user interface.</para>
        <figure id="fig-security-hudson-db">
          <title>Overview of the available security settings</title>
          <mediaobject>
            <imageobject role="web">
              <imagedata contentdepth="100%"
                         fileref="figs/web/security-hudson-db.png" scalefit="1"/>
            </imageobject>
            <imageobject role="print">
              <imagedata align="center" fileref="figs/print/security-hudson-db.pdf"
                         scalefit="0" width="100%"/>
            </imageobject>
          </mediaobject>
        </figure>
      </section>

      <section>
        <title>Light-weight Directory Authentication Protocol (LDAP)</title>
        <para>If you have an LDAP server, Hudson can be configured to use
        this server to authenticate users.</para>
        <figure id="fig-security-ldap">
          <title>Overview of the available security settings</title>
          <mediaobject>
            <imageobject role="web">
              <imagedata contentdepth="100%"
                         fileref="figs/web/security-ldap.png" scalefit="1"/>
            </imageobject>
            <imageobject role="print">
              <imagedata align="center" fileref="figs/print/security-ldap.pdf"
                         scalefit="0" width="100%"/>
            </imageobject>
          </mediaobject>
        </figure>
        <!--We need a section to motiviate the LDAP realm, talk about when to use it.   This section also needs to talk about compatibility with
  various LDAP implementations, and it needs to provide a step-by-step walkthrough.
  SEE HBOOK-48-->
        <para></para>
      </section>

    </section>

    <section>

      <title>Configuring an Authorization Strategy</title>
      <para></para>

      <section>
        <title>Logged-in users can do anything</title>

        <!--what are the consequences.. -->

      </section>

      <section>
        <title>Using a Global Authorization Strategy</title>
        <figure id="fig-security-authorization-matrix">
          <title>Matrix based</title>
          <mediaobject>
            <imageobject role="web">
              <imagedata contentdepth="100%"
                         fileref="figs/web/security-authorization-matrix.png" scalefit="1"/>
            </imageobject>
            <imageobject role="print">
              <imagedata align="center"
                         fileref="figs/print/security-authorization-matrix.pdf"
                         scalefit="0" width="100%"/>
            </imageobject>
          </mediaobject>
        </figure>

        <!--SEE HBOOK-53 - Explain this approach, called matrix based
        security-->

        <para></para>
      </section>

      <section>
        <title>Using a Project-based Authorization Strategy</title>
        <figure id="fig-security-authorization-project">
          <title>Project-based Authorization Strategy</title>
          <mediaobject>
            <imageobject role="web">
              <imagedata contentdepth="100%"
                         fileref="figs/web/security-authorization-project.png" scalefit="1"/>
            </imageobject>
            <imageobject role="print">
              <imagedata align="center" fileref="figs/print/security-authorization-project.pdf"
                         scalefit="0" width="100%"/>
            </imageobject>
          </mediaobject>
        </figure>
        <!--SEE HBOOK-51 - Write a section about Project-based Authorization Strategy-->

        <para></para>
      </section>

      <section>
        <title>Using the Legacy Authorization Strategy</title>

        <!--SEE HBOOK-52 - Legacy to what?   Explain what this mode means to the user.-->

        <para></para>
      </section>

      <section>
        <title>Anyone can do anything</title>
        <!--what are the consequences.. -->
      </section>

    </section>
  </section>

  <section>
    <title>Hudson Security Best Practices</title>
    <!--SEE HBOOK-54 - Give the user some recommendations for configuring Hudson Security-->

    <para></para>
  </section>
</chapter>
